// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource postgresql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id       String  @id @default(cuid())
  name     String  @default("")
  email    String  @unique @default("")
  password String
  role     Role?   @relation("User_role", fields: [roleId], references: [id])
  roleId   String? @map("role")

  @@index([roleId])
}

model Role {
  id                         String  @id @default(cuid())
  name                       String  @default("")
  canSeeOtherPeople          Boolean @default(false)
  canEditOtherPeople         Boolean @default(false)
  canManagePeople            Boolean @default(false)
  canManageRoles             Boolean @default(false)
  canAccessDashboard         Boolean @default(false)
  canManageTools             Boolean @default(false)
  canManageCategories        Boolean @default(false)
  canManageFeatures          Boolean @default(false)
  canManageAlternatives      Boolean @default(false)
  canManageDeploymentOptions Boolean @default(false)
  canManageTechStacks        Boolean @default(false)
  assignedTo                 User[]  @relation("User_role")
}

model Category {
  id          String    @id @default(cuid())
  name        String    @default("")
  slug        String    @unique @default("")
  description String    @default("")
  icon        String    @default("")
  color       String    @default("")
  createdAt   DateTime? @default(now())
  tools       Tool[]    @relation("Tool_category")
  features    Feature[] @relation("Feature_category")
}

model Tool {
  id                      String             @id @default(cuid())
  name                    String             @default("")
  slug                    String             @unique @default("")
  description             String             @default("")
  websiteUrl              String             @default("")
  repositoryUrl           String             @default("")
  logoUrl                 String             @default("")
  logoSvg                 String             @default("")
  isOpenSource            Boolean            @default(false)
  category                Category?          @relation("Tool_category", fields: [categoryId], references: [id])
  categoryId              String?            @map("category")
  license                 String             @default("")
  githubStars             Int?
  status                  String?            @default("active")
  pricingModel            String?
  createdAt               DateTime?          @default(now())
  updatedAt               DateTime?          @default(now()) @updatedAt
  features                ToolFeature[]      @relation("ToolFeature_tool")
  proprietaryAlternatives Alternative[]      @relation("Alternative_proprietaryTool")
  openSourceAlternatives  Alternative[]      @relation("Alternative_openSourceTool")
  deploymentOptions       DeploymentOption[] @relation("DeploymentOption_tool")
  techStacks              ToolTechStack[]    @relation("ToolTechStack_tool")

  @@index([categoryId])
}

model Feature {
  id          String        @id @default(cuid())
  name        String        @default("")
  slug        String        @unique @default("")
  description String        @default("")
  category    Category?     @relation("Feature_category", fields: [categoryId], references: [id])
  categoryId  String?       @map("category")
  featureType String?
  createdAt   DateTime?     @default(now())
  tools       ToolFeature[] @relation("ToolFeature_feature")

  @@index([categoryId])
}

model ToolFeature {
  id                  String    @id @default(cuid())
  tool                Tool?     @relation("ToolFeature_tool", fields: [toolId], references: [id])
  toolId              String?   @map("tool")
  feature             Feature?  @relation("ToolFeature_feature", fields: [featureId], references: [id])
  featureId           String?   @map("feature")
  implementationNotes String    @default("")
  qualityScore        Int?
  verified            Boolean   @default(false)
  createdAt           DateTime? @default(now())

  @@index([toolId])
  @@index([featureId])
}

model Alternative {
  id                String    @id @default(cuid())
  proprietaryTool   Tool?     @relation("Alternative_proprietaryTool", fields: [proprietaryToolId], references: [id])
  proprietaryToolId String?   @map("proprietaryTool")
  openSourceTool    Tool?     @relation("Alternative_openSourceTool", fields: [openSourceToolId], references: [id])
  openSourceToolId  String?   @map("openSourceTool")
  similarityScore   Decimal?  @postgresql.Decimal(3, 2)
  matchType         String?
  comparisonNotes   String    @default("")
  createdAt         DateTime? @default(now())

  @@index([proprietaryToolId])
  @@index([openSourceToolId])
}

model DeploymentOption {
  id            String    @id @default(cuid())
  tool          Tool?     @relation("DeploymentOption_tool", fields: [toolId], references: [id])
  toolId        String?   @map("tool")
  platform      String    @default("")
  deployUrl     String    @default("")
  templateUrl   String    @default("")
  difficulty    String?
  estimatedTime String    @default("")
  requirements  Json?
  isVerified    Boolean   @default(false)
  createdAt     DateTime? @default(now())

  @@index([toolId])
}

model TechStack {
  id      String          @id @default(cuid())
  name    String          @default("")
  type    String?
  color   String          @default("")
  iconUrl String          @default("")
  tools   ToolTechStack[] @relation("ToolTechStack_techStack")
}

model ToolTechStack {
  id          String     @id @default(cuid())
  tool        Tool?      @relation("ToolTechStack_tool", fields: [toolId], references: [id])
  toolId      String?    @map("tool")
  techStack   TechStack? @relation("ToolTechStack_techStack", fields: [techStackId], references: [id])
  techStackId String?    @map("techStack")
  isPrimary   Boolean    @default(false)

  @@index([toolId])
  @@index([techStackId])
}
